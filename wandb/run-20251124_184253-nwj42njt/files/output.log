Loading DOI map from data/processed/embeddings/Bi_RankNet_HardNeg_v2_FixLR/corpus_doi_map.json...
Loading embeddings (mmap) from data/processed/embeddings/Bi_RankNet_HardNeg_v2_FixLR/corpus_embeddings.npy...
Building Faiss Index for candidate retrieval...
Indexing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 233/233 [00:30<00:00,  7.54it/s]
Loading query encoder: models/checkpoints/bi_encoder/20251123_042811/best_model
/home/kurokawa/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading queries from data/processed/evaluation_dataset_rich.jsonl...
Loaded 312 queries.
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 312/312 [1:08:10<00:00, 13.11s/it]

=== Evaluation Results (Retriever) ===
MRR: 0.0001
Recall@1: 0.0000
Recall@5: 0.0000
Recall@10: 0.0000
Recall@50: 0.0000
Recall@100: 0.0032
Recall@300: 0.0096
Recall@500: 0.0128
Recall@1000: 0.0160
Recall@2000: 0.0224
Recall@3000: 0.0417
Recall@4000: 0.0449
Recall@5000: 0.0449
Recall@6000: 0.0481
Recall@7000: 0.0545
Recall@8000: 0.0577
Recall@9000: 0.0705
Recall@10000: 0.0737
Recall@11000: 0.0801
Recall@12000: 0.0833
Recall@13000: 0.0929
Recall@14000: 0.0962
Recall@15000: 0.1090
Recall@16000: 0.1122
Recall@17000: 0.1154
Recall@18000: 0.1282
Recall@19000: 0.1282
Recall@20000: 0.1314
Recall@21000: 0.1346
Recall@22000: 0.1378
Recall@23000: 0.1474
Recall@24000: 0.1506
Recall@25000: 0.1603
Recall@26000: 0.1603
Recall@27000: 0.1635
Recall@28000: 0.1667
Recall@29000: 0.1699
Recall@30000: 0.1731
Recall@31000: 0.1763
Recall@32000: 0.1827
Recall@33000: 0.1891
Recall@34000: 0.1891
Recall@35000: 0.1923
Recall@36000: 0.1955
Recall@37000: 0.1987
Recall@38000: 0.2083
Recall@39000: 0.2083
Recall@40000: 0.2083
Recall@41000: 0.2147
Recall@42000: 0.2179
Recall@43000: 0.2179
Recall@44000: 0.2244
Recall@45000: 0.2340
Recall@46000: 0.2372
Recall@47000: 0.2372
Recall@48000: 0.2404
Recall@49000: 0.2404
Recall@50000: 0.2436
Saving candidates for reranking to data/processed/embeddings/Bi_RankNet_HardNeg_v2_FixLR/candidates_for_reranking.json...
