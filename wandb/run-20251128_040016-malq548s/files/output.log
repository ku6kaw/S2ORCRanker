Loading DOI map from data/processed/embeddings/SPECTER2_Adapter/corpus_doi_map.json...
Loading embeddings (mmap) from data/processed/embeddings/SPECTER2_Adapter/corpus_embeddings.npy...
Building Faiss Index for candidate retrieval...
Indexing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 233/233 [00:30<00:00,  7.56it/s]
Loading query encoder: models/checkpoints/bi_encoder/Bi_SPECTER2_MNRL_AdapterInit_Full/best_model
Some weights of the model checkpoint at models/checkpoints/bi_encoder/Bi_SPECTER2_MNRL_AdapterInit_Full/best_model were not used when initializing SiameseBiEncoder: ['bert.encoder.layer.0.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.0.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.0.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.0.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.1.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.1.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.1.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.1.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.10.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.10.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.10.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.10.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.11.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.11.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.11.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.11.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.2.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.2.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.2.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.2.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.3.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.3.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.3.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.3.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.4.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.4.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.4.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.4.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.5.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.5.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.5.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.5.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.6.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.6.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.6.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.6.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.7.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.7.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.7.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.7.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.8.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.8.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.8.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.8.output.adapters.[PRX].adapter_up.weight', 'bert.encoder.layer.9.output.adapters.[PRX].adapter_down.0.bias', 'bert.encoder.layer.9.output.adapters.[PRX].adapter_down.0.weight', 'bert.encoder.layer.9.output.adapters.[PRX].adapter_up.bias', 'bert.encoder.layer.9.output.adapters.[PRX].adapter_up.weight']
- This IS expected if you are initializing SiameseBiEncoder from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SiameseBiEncoder from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of SiameseBiEncoder were not initialized from the model checkpoint at models/checkpoints/bi_encoder/Bi_SPECTER2_MNRL_AdapterInit_Full/best_model and are newly initialized: ['classifier_head.0.bias', 'classifier_head.0.weight', 'classifier_head.2.bias', 'classifier_head.2.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
ðŸ”„ Loading Adapter config: allenai/specter2
   Attempting to load adapter from checkpoint: models/checkpoints/bi_encoder/Bi_SPECTER2_MNRL_AdapterInit_Full/best_model
   Checkpoint load failed (No file pytorch_adapter.bin or no file adapter_config.json found in directory models/checkpoints/bi_encoder/Bi_SPECTER2_MNRL_AdapterInit_Full/best_model), falling back to Hub: allenai/specter2
[2025-11-28 04:00:52,107][adapters.utils][INFO] - Attempting to load adapter from HF Model Hub...
Fetching 4 files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 3358.80it/s]
[2025-11-28 04:00:52,337][adapters.loading][INFO] - Loading module configuration from /home/kurokawa/.cache/huggingface/hub/models--allenai--specter2/snapshots/2081559630a80fc5851d8f798a05ba81e9468089/adapter_config.json
[2025-11-28 04:00:52,340][adapters.configuration.model_adapters_config][INFO] - Adding adapter '[PRX]'.
[2025-11-28 04:00:52,358][adapters.model_mixin][WARNING] - There are adapters available but none are activated for the forward pass.
[2025-11-28 04:00:52,368][adapters.loading][INFO] - Loading module weights from /home/kurokawa/.cache/huggingface/hub/models--allenai--specter2/snapshots/2081559630a80fc5851d8f798a05ba81e9468089/pytorch_adapter.bin
âœ… Adapter '[PRX]' activated.
Loading queries from data/processed/evaluation_dataset_rich.jsonl...
Sampling 1 query(s) per dataset...
Reduced queries from 312 to 50.
Loaded 50 queries for evaluation.
Evaluating: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [08:23<00:00, 10.08s/it]

=== Evaluation Results (Retriever) ===
MRR: 0.0001
Recall@1: 0.0000
Recall@5: 0.0000
Recall@10: 0.0000
Recall@50: 0.0000
Recall@100: 0.0000
Recall@300: 0.0000
Recall@500: 0.0000
Recall@1000: 0.0000
Recall@2000: 0.0000
Recall@3000: 0.0000
Recall@4000: 0.0000
Recall@5000: 0.0000
Recall@6000: 0.0000
Recall@7000: 0.0000
Recall@8000: 0.0000
Recall@9000: 0.0000
Recall@10000: 0.0000
Recall@11000: 0.0000
Recall@12000: 0.0000
Recall@13000: 1.0000
Recall@14000: 1.0000
Recall@15000: 1.0000
Recall@16000: 1.0000
Recall@17000: 1.0000
Recall@18000: 1.0000
Recall@19000: 1.0000
Recall@20000: 1.0000
Recall@21000: 1.0000
Recall@22000: 1.0000
Recall@23000: 1.0000
Recall@24000: 1.0000
Recall@25000: 1.0000
Recall@26000: 1.0000
Recall@27000: 1.0000
Recall@28000: 1.0000
Recall@29000: 1.0000
Recall@30000: 1.0000
Recall@31000: 1.0000
Recall@32000: 1.0000
Recall@33000: 1.0000
Recall@34000: 1.0000
Recall@35000: 1.0000
Recall@36000: 1.0000
Recall@37000: 1.0000
Recall@38000: 1.0000
Recall@39000: 1.0000
Recall@40000: 1.0000
Recall@41000: 1.0000
Recall@42000: 1.0000
Recall@43000: 1.0000
Recall@44000: 1.0000
Recall@45000: 1.0000
Recall@46000: 1.0000
Recall@47000: 1.0000
Recall@48000: 1.0000
Recall@49000: 1.0000
Recall@50000: 1.0000
