Loading DOI map from data/processed/legacy_embeddings/pretrained_doi_map.json...
Loading embeddings (mmap)...
Building Faiss Index...
Indexing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 233/233 [00:34<00:00,  6.69it/s]
Loading query encoder: models/output_model/best_model
/home/kurokawa/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Some weights of SiameseBiEncoder were not initialized from the model checkpoint at allenai/scibert_scivocab_uncased and are newly initialized: ['classifier_head.0.bias', 'classifier_head.0.weight', 'classifier_head.2.bias', 'classifier_head.2.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading Ground Truth: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:00<00:00, 989.61it/s]
Evaluating:  57%|█████████████████████████████████████████████████████████████████████████████████▉                                                               | 26/46 [01:28<01:07,  3.39s/it]
Traceback (most recent call last):
  File "/home/kurokawa/Projects/S2ORCRanker/scripts/evaluate.py", line 205, in <module>
    main()
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/kurokawa/Projects/S2ORCRanker/scripts/evaluate.py", line 141, in main
    D, I = index.search(q_vec, search_k)
  File "/home/kurokawa/.local/lib/python3.10/site-packages/faiss/__init__.py", line 322, in replacement_search
    self.search_c(n, swig_ptr(x), k, swig_ptr(D), swig_ptr(I))
  File "/home/kurokawa/.local/lib/python3.10/site-packages/faiss/swigfaiss.py", line 2146, in search
    return _swigfaiss.IndexFlat_search(self, n, x, k, distances, labels)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/kurokawa/Projects/S2ORCRanker/scripts/evaluate.py", line 205, in <module>
    main()
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/kurokawa/.local/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/kurokawa/Projects/S2ORCRanker/scripts/evaluate.py", line 141, in main
    D, I = index.search(q_vec, search_k)
  File "/home/kurokawa/.local/lib/python3.10/site-packages/faiss/__init__.py", line 322, in replacement_search
    self.search_c(n, swig_ptr(x), k, swig_ptr(D), swig_ptr(I))
  File "/home/kurokawa/.local/lib/python3.10/site-packages/faiss/swigfaiss.py", line 2146, in search
    return _swigfaiss.IndexFlat_search(self, n, x, k, distances, labels)
KeyboardInterrupt
