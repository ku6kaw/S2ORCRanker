/home/kurokawa/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading dataset from: data/processed/training_dataset_abstract_cleaned_v3.csv
Performing Group Shuffle Split based on 'anchor' (or 'abstract_a')...
Train set: 27208, Validation set: 7416
Tokenizing...
Map (num_proc=4): 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 27208/27208 [00:07<00:00, 3786.80 examples/s]
Map (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7416/7416 [00:02<00:00, 3590.90 examples/s]
Loading model: allenai/scibert_scivocab_uncased
/home/kurokawa/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Bi-Encoder Head: ranknet, Loss: pair_score
Some weights of SiameseBiEncoder were not initialized from the model checkpoint at allenai/scibert_scivocab_uncased and are newly initialized: ['classifier_head.0.bias', 'classifier_head.0.weight', 'classifier_head.2.bias', 'classifier_head.2.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Using BiEncoderPairTrainer (Classification Head)
Early stopping enabled with patience: 3
Error executing job with overrides: ['debug=false', 'logging.run_name=Bi_RankNet_Random_neg_SameLR', 'model.type=bi_encoder', 'model.head_type=ranknet', 'data.train_file=data/processed/training_dataset_abstract_cleaned_v3.csv', 'training.epochs=3', 'training.batch_size=32', 'training.learning_rate=2e-5', 'training.head_learning_rate=2e-5']
Traceback (most recent call last):
  File "/home/kurokawa/Projects/S2ORCRanker/scripts/run_train.py", line 252, in main
    trainer = trainer_cls(
TypeError: Trainer.__init__() got an unexpected keyword argument 'margin'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
